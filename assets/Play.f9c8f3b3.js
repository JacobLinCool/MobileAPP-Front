import{d as $,z as F,n as E,c as n,l as _,e,a as U,w as q,T as z,p as L,b as N,o as c,u,q as B,y as p,t as i,F as H,s as R,x as G,v as J}from"./vendor.0df4e93f.js";import{S as w}from"./sweetalert2.314ae3be.js";import{_ as K}from"./index.a40f8658.js";const h=g=>(L("data-v-eae99462"),g=g(),N(),g),O={id:"play"},Q={id:"container"},W=h(()=>e("div",{id:"safe-area",class:"w-full my-3"},null,-1)),X={id:"wrapper"},Y={key:0},Z=h(()=>e("h1",{style:{"font-size":"1.6rem"}},"\u52A0\u5165\u904A\u6232",-1)),ee={class:"ch"},te=h(()=>e("label",{class:"ch-label"},"\u904A\u6232 ID",-1)),se={key:1},le=h(()=>e("h1",{style:{"font-size":"1.6rem"}},"\u904A\u6232\u8CC7\u8A0A",-1)),oe={class:"ch"},ue={class:"ch-label text-lg"},ae={class:"ch-label text-md"},ne={class:"ch"},ce={class:"ch-label text-lg"},ie={class:"ch"},de=h(()=>e("label",{class:"ch-label"},"\u8F38\u5165\u73A9\u5BB6\u540D\u7A31",-1)),he=h(()=>e("label",{class:"ch-label"},"\u9078\u64C7\u968A\u4F0D\u540D\u7A31",-1)),re=["value"],_e={key:2},pe={class:"text-3xl"},ge={class:"ch"},ve={class:"ch-label text-lg"},me={key:0,class:"ch"},fe={class:"ch-label text-lg"},Ae={class:"ch-label text-lg"},Fe={key:1,class:"ch"},De=h(()=>e("p",{class:"ch-label text-lg"},"\u8ACB\u8F38\u5165\u6307\u5B9A\u5BC6\u78BC",-1)),Be=$({setup(g){function v(o,t=""){w.fire({title:o,text:t,icon:"error",confirmButtonText:"\u78BA\u5B9A"})}function C(o,t=""){w.fire({title:o,text:t,icon:"success",confirmButtonText:"\u78BA\u5B9A"})}const M="https://mobile-app-server.jacoblincool.repl.co",d=F(0),s=E({id:""});if(location.search.includes("?id=")){const o=location.search.split("?id=")[1];s.id=o}const a=E({name:"",team:"",challenge:0}),m=F(""),f=F(""),k=F(0);function I(){if(s.id.length===0){v("\u8ACB\u8F38\u5165\u904A\u6232 ID");return}const o=`${M}/get?id=${s.id}`;fetch(o).then(t=>t.json()).then(async t=>{if(t.name){for(const l in t)s[l]=t[l];console.log(s),d.value=1}else v("\u52A0\u5165\u5931\u6557","\u8ACB\u78BA\u8A8D\u904A\u6232 ID \u662F\u5426\u6B63\u78BA")})}function S(){console.log(s,a),d.value=2,k.value=setInterval(async()=>{const o=await j();console.log(o),f.value=`${o.coords.latitude}, ${o.coords.longitude}`},3e3)}function V(){if(s.challenges[a.challenge].mode===0){const o=+s.challenges[a.challenge].gps.split(",")[0].trim(),t=+s.challenges[a.challenge].gps.split(",")[1].trim(),l=+f.value.split(",")[0].trim(),D=+f.value.split(",")[1].trim(),r=Math.floor(P(o,t,l,D));console.log(r),r<=200?(a.challenge++,a.challenge>=s.challenges.length&&(C("\u904A\u6232\u7D50\u675F","\u606D\u559C\u4F60\u904E\u95DC\u4E86"),d.value=0)):v("\u4E0D\u5728\u6307\u5B9A\u4F4D\u7F6E\u9644\u8FD1",`\u76EE\u524D\u8DDD\u96E2 ${r} \u516C\u5C3A`)}else m.value===s.challenges[a.challenge].secret?(a.challenge++,m.value="",a.challenge>=s.challenges.length&&(C("\u904A\u6232\u7D50\u675F","\u606D\u559C\u4F60\u904E\u95DC\u4E86"),d.value=0)):v("\u5BC6\u78BC\u932F\u8AA4")}function j(){return new Promise((o,t)=>{navigator.geolocation.getCurrentPosition(l=>{o(l)},l=>{t(l)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:0})})}function P(o,t,l,D){const r=6371,b=A(l-o),x=A(D-t),y=Math.sin(b/2)*Math.sin(b/2)+Math.cos(A(o))*Math.cos(A(l))*Math.sin(x/2)*Math.sin(x/2),T=2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y));return r*T*1e3}function A(o){return o*(Math.PI/180)}return(o,t)=>(c(),n("div",O,[_(e("div",Q,[W,e("div",X,[U(z,{name:"fade",mode:"out-in"},{default:q(()=>[e("div",null,[d.value===0?(c(),n("div",Y,[Z,e("div",ee,[te,_(e("input",{class:"ch-input","onUpdate:modelValue":t[0]||(t[0]=l=>u(s).id=l),placeholder:"abc123"},null,512),[[B,u(s).id]]),e("button",{onClick:I},"\u52A0\u5165")])])):p("",!0),d.value===1?(c(),n("div",se,[le,e("div",oe,[e("p",ue,i(u(s).name),1),e("p",ae,i(u(s).description),1)]),e("div",ne,[e("p",ce,"\u95DC\u5361\u6578\uFF1A "+i(u(s).challenges.length),1)]),e("div",ie,[de,_(e("input",{class:"ch-input","onUpdate:modelValue":t[1]||(t[1]=l=>u(a).name=l),placeholder:"player"},null,512),[[B,u(a).name]]),he,_(e("select",{class:"ch-input","onUpdate:modelValue":t[2]||(t[2]=l=>u(a).team=l)},[(c(!0),n(H,null,R(u(s).teams,l=>(c(),n("option",{value:l},i(l),9,re))),256))],512),[[G,u(a).team]]),e("button",{onClick:S},"\u958B\u59CB\u904A\u6232")])])):p("",!0),d.value===2?(c(),n("div",_e,[e("h1",pe,i(u(s).challenges[u(a).challenge].name),1),e("div",ge,[e("p",ve,i(u(s).challenges[u(a).challenge].description),1)]),u(s).challenges[u(a).challenge].mode===0?(c(),n("div",me,[e("p",fe,"\u8ACB\u79FB\u52D5\u81F3\u6307\u5B9A\u4F4D\u7F6E\uFF1A "+i(u(s).challenges[u(a).challenge].gps),1),e("p",Ae,"\u73FE\u5728\u4F4D\u7F6E\uFF1A "+i(f.value||"\u53D6\u5F97\u4F4D\u7F6E\u4E2D..."),1)])):p("",!0),u(s).challenges[u(a).challenge].mode===1?(c(),n("div",Fe,[De,_(e("input",{class:"ch-input","onUpdate:modelValue":t[3]||(t[3]=l=>m.value=l),placeholder:"password"},null,512),[[B,m.value]])])):p("",!0),e("div",{class:"ch"},[e("button",{onClick:V},"\u4E0B\u4E00\u95DC")])])):p("",!0)])]),_:1})])],512),[[J,!0]])]))}});var Ee=K(Be,[["__scopeId","data-v-eae99462"]]);export{Ee as default};
