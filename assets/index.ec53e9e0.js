var P=Object.defineProperty;var j=(_,r,d)=>r in _?P(_,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):_[r]=d;var g=(_,r,d)=>(j(_,typeof r!="symbol"?r+"":r,d),d);import{r as V,o as p,c as h,a as l,w as m,v as f,u as c,F as U,b as k,t as N,d as F,e as y,f as M}from"./vendor.ac17a239.js";const G=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))b(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&b(u)}).observe(document,{childList:!0,subtree:!0});function d(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function b(s){if(s.ep)return;s.ep=!0;const o=d(s);fetch(s.href,o)}};G();const A={id:"challenge-creator"},B=l("h1",{class:"text-xl"},"\u5EFA\u7ACB\u904A\u6232",-1),D=l("p",null,null,-1),I={class:"ch game"},T=l("label",{class:"ch-label"},"\u904A\u6232\u540D\u7A31",-1),E=l("label",{class:"ch-label"},"\u904A\u6232\u8AAA\u660E",-1),J=l("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u6578",-1),q=["value"],K=l("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u5206",-1),z=["value"],H={class:"ch teams"},Q=l("label",{class:"ch-label"},"\u5206\u7D44\u7D44\u5225",-1),R={class:"ch-team"},W={class:"ch-label"},X=["onUpdate:modelValue"],Y=l("button",null,"\u5132\u5B58",-1),Z=[Y],ee=l("label",{class:"ch-label"},"\u95DC\u5361\u540D\u7A31",-1),te=["onUpdate:modelValue","placeholder"],le=l("label",{class:"ch-label"},"\u95DC\u5361\u8AAA\u660E",-1),se=["onUpdate:modelValue"],oe=l("label",{class:"ch-label"},"\u95DC\u5361\u5206\u6578",-1),ne=["onUpdate:modelValue","placeholder"],ae=l("label",{class:"ch-label"},"\u95DC\u5361\u6A21\u5F0F",-1),ie=["onUpdate:modelValue"],re=["value"],ce={key:0,class:"ch-label"},de=["onUpdate:modelValue"],ue={key:2,class:"ch-label"},pe=["onUpdate:modelValue","placeholder"],he=["onClick"],me=l("button",null,"\u65B0\u589E",-1),fe=[me],_e={setup(_){const r="https://mobile-app-server.jacoblincool.repl.co",d=["GPS \u5B9A\u4F4D\u6311\u6230","\u901A\u95DC\u5BC6\u78BC\u6311\u6230"];class b{constructor(e="",t="",i=10,n=0){g(this,"name","");g(this,"description","");g(this,"points",0);g(this,"mode",0);g(this,"secret",null);g(this,"gps",null);this.name=e,this.description=t,this.points=i,this.mode=n,this.secret=Math.floor(36**5+1+Math.random()*(36**5*35-1)).toString(36)}}const s=V({name:"",description:""}),o=V([new b]),u=V([]);function w(){o.push(new b),console.log(o)}function C(a){o.splice(a,1),console.log(o)}async function L(a){a.target.disabled=!0;const e=x();if(console.log("validation: ",e),e){for(const v of o)v.gps&&(v.gps=v.gps.split(",").map(O=>parseFloat(O.trim())).splice(0,2).join(","));const t={name:s.name,description:s.description,challenges:o,teams:u};console.log(JSON.stringify(t,null,2));const n=await(await fetch(r+"/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();n.error?alert(n.msg):alert("\u904A\u6232\u5DF2\u5EFA\u7ACB\uFF01 ID: "+n.id)}a.target.disabled=!1}function S(a){try{const[e,t]=a.split(",").map(i=>parseFloat(i.trim()));return!(isNaN(e)||isNaN(t)||e<-90||e>90||t<-180||t>180)}catch{return!1}}function $(a){S(a.target.value)?a.target.classList.remove("error"):a.target.classList.add("error")}function x(){try{if(s.name.length===0||s.name.length>30)return alert("\u904A\u6232\u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143"),!1;if(s.description.length===0||s.description.length>1e3)return alert("\u904A\u6232\u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143"),!1;if(o.length===0||o.length>100)return alert("\u95DC\u5361\u7E3D\u6578\u9700\u4ECB\u65BC 1 ~ 100 \u500B"),!1;for(const e of o){if(e.name.length===0||e.name.length>30)return alert(`\u95DC\u5361 ${e.name} \u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143`),!1;if(e.description.length===0||e.description.length>1e3)return alert(`\u95DC\u5361 ${e.name} \u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143`),!1;if(e.points<0||e.points>1e9)return alert(`\u95DC\u5361 ${e.name} \u734E\u52F5\u5206\u6578\u9700\u4ECB\u65BC 0 ~ 1000000000`),!1;if(e.mode<0||e.mode>=d.length)return alert(`\u95DC\u5361 ${e.name} \u6A21\u5F0F\u932F\u8AA4`),!1;if(e.mode===0&&!S(e.gps))return alert(`\u95DC\u5361 ${e.name} GPS \u4F4D\u7F6E\u932F\u8AA4`),!1;if(e.mode===1&&e.secret.length===0)return alert(`\u95DC\u5361 ${e.name} \u901A\u95DC\u5BC6\u78BC\u4E0D\u53EF\u70BA\u7A7A`),!1}const a=new Set;for(const e of u){if(e.length===0||e.length>30)return alert("\u968A\u4F0D\u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143"),!1;if(a.has(e))return alert("\u968A\u4F0D\u540D\u7A31\u4E0D\u53EF\u91CD\u8907"),!1;a.add(e)}return!0}catch{return alert("\u8CC7\u6599\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u586B\u5BEB"),!1}}return(a,e)=>(p(),h("div",A,[B,D,l("div",I,[T,m(l("input",{class:"ch-input","onUpdate:modelValue":e[0]||(e[0]=t=>c(s).name=t),placeholder:"\u6211\u7684\u8D85\u9177\u904A\u6232"},null,512),[[f,c(s).name]]),E,m(l("input",{class:"ch-input","onUpdate:modelValue":e[1]||(e[1]=t=>c(s).description=t),placeholder:"\u904A\u6232\u7684\u8AAA\u660E"},null,512),[[f,c(s).description]]),J,l("input",{class:"ch-input",value:c(o).length,disabled:""},null,8,q),K,l("input",{class:"ch-input",value:c(o).reduce((t,i)=>t+i.points,0),disabled:""},null,8,z)]),l("div",H,[Q,(p(!0),h(U,null,k(c(u),(t,i)=>(p(),h("div",R,[l("label",W,"\u7B2C "+N(i+1)+" \u7D44\u540D\u7A31",1),m(l("input",{class:"ch-input","onUpdate:modelValue":n=>c(u)[i]=n,placeholder:"\u7D44\u5225\u540D\u7A31"},null,8,X),[[f,c(u)[i]]])]))),256)),l("button",{class:"ch-button text-right w-full pr-2",onClick:e[2]||(e[2]=t=>c(u).push(""))},"\u65B0\u589E\u7D44\u5225")]),l("div",{id:"save-game",class:"ch",onClick:L},Z),l("div",null,[(p(!0),h(U,null,k(c(o),(t,i)=>(p(),h("div",{key:i,class:"ch"},[ee,m(l("input",{type:"text",class:"ch-input","onUpdate:modelValue":n=>t.name=n,placeholder:"\u8D85\u9177\u7684\u7B2C "+(i+1)+" \u95DC",title:"\u95DC\u5361\u540D\u7A31"},null,8,te),[[f,t.name]]),le,m(l("input",{type:"text",class:"ch-input","onUpdate:modelValue":n=>t.description=n,placeholder:"\u95DC\u65BC\u9019\u95DC\u7684\u524D\u60C5\u63D0\u8981\uFF1F\u6216\u662F\u5167\u5BB9\u8AAA\u660E\uFF1F",title:"\u95DC\u5361\u8AAA\u660E"},null,8,se),[[f,t.description]]),oe,m(l("input",{type:"number",class:"ch-input","onUpdate:modelValue":n=>t.points=n,placeholder:"\u7B2C "+(i+1)+" \u95DC\u7684\u5206\u6578",title:"\u95DC\u5361\u5206\u6578"},null,8,ne),[[f,t.points]]),ae,m(l("select",{class:"ch-input","onUpdate:modelValue":n=>t.mode=n},[(p(),h(U,null,k(d,(n,v)=>l("option",{value:v},N(n),9,re)),64))],8,ie),[[F,t.mode]]),t.mode==0?(p(),h("label",ce,"\u76EE\u7684\u5730 GPS \u5EA7\u6A19")):y("",!0),t.mode==0?m((p(),h("input",{key:1,type:"text",class:"ch-input","onUpdate:modelValue":n=>t.gps=n,placeholder:"25.0275, 121.5282",title:"GPS",onInput:$},null,40,de)),[[f,t.gps]]):y("",!0),t.mode==1?(p(),h("label",ue,"\u901A\u95DC\u5BC6\u78BC")):y("",!0),t.mode==1?m((p(),h("input",{key:3,type:"text",class:"ch-input","onUpdate:modelValue":n=>t.secret=n,placeholder:"\u7B2C "+(i+1)+" \u95DC\u7684\u901A\u95DC\u5BC6\u78BC",title:"\u901A\u95DC\u5BC6\u78BC"},null,8,pe)),[[f,t.secret]]):y("",!0),l("button",{class:"ch-del",onClick:n=>C(i),tabindex:"-1"},"\u522A\u9664",8,he)]))),128)),l("div",{id:"add-challenge",class:"ch",onClick:w},fe)])]))}};M(_e).mount("#app");
