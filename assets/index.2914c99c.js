var C=Object.defineProperty;var O=(h,r,c)=>r in h?C(h,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):h[r]=c;var m=(h,r,c)=>(O(h,typeof r!="symbol"?r+"":r,c),c);import{r as U,o as d,c as u,a as s,w as p,v as f,u as _,F as k,b as N,d as P,t as $,e as v,f as j}from"./vendor.ac17a239.js";const F=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const b of o.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&g(b)}).observe(document,{childList:!0,subtree:!0});function c(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(l){if(l.ep)return;l.ep=!0;const o=c(l);fetch(l.href,o)}};F();const M={id:"challenge-creator"},G=s("h1",{class:"text-xl"},"\u5EFA\u7ACB\u904A\u6232",-1),A=s("p",null,null,-1),B={class:"ch game"},D=s("label",{class:"ch-label"},"\u904A\u6232\u540D\u7A31",-1),I=s("label",{class:"ch-label"},"\u904A\u6232\u8AAA\u660E",-1),T=s("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u6578",-1),E=["value"],J=s("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u5206",-1),q=["value"],K=s("button",null,"\u5132\u5B58",-1),z=[K],H=s("label",{class:"ch-label"},"\u95DC\u5361\u540D\u7A31",-1),Q=["onUpdate:modelValue","placeholder"],R=s("label",{class:"ch-label"},"\u95DC\u5361\u8AAA\u660E",-1),W=["onUpdate:modelValue"],X=s("label",{class:"ch-label"},"\u95DC\u5361\u5206\u6578",-1),Y=["onUpdate:modelValue","placeholder"],Z=s("label",{class:"ch-label"},"\u95DC\u5361\u6A21\u5F0F",-1),ee=["onUpdate:modelValue"],te=["value"],le={key:0,class:"ch-label"},se=["onUpdate:modelValue"],oe={key:2,class:"ch-label"},ne=["onUpdate:modelValue","placeholder"],ae=["onClick"],ie=s("button",null,"\u65B0\u589E",-1),re=[ie],ce={setup(h){const r="https://mobile-app-server.jacoblincool.repl.co",c=["GPS \u5B9A\u4F4D\u6311\u6230","\u901A\u95DC\u5BC6\u78BC\u6311\u6230"];class g{constructor(i="",t="",a=10,n=0){m(this,"name","");m(this,"description","");m(this,"points",0);m(this,"mode",0);m(this,"secret",null);m(this,"gps",null);this.name=i,this.description=t,this.points=a,this.mode=n,this.secret=Math.floor(36**5+1+Math.random()*(36**5*35-1)).toString(36)}}const l=U({name:"",description:""}),o=U([new g]);function b(){o.push(new g),console.log(o)}function S(e){o.splice(e,1),console.log(o)}async function w(e){e.target.disabled=!0;const i=x();if(console.log("validation: ",i),i){for(const n of o)n.gps&&(n.gps=n.gps.split(",").map(y=>parseFloat(y.trim())).splice(0,2).join(","));console.log(JSON.stringify({name:l.name,description:l.description,challenges:o},null,2));const a=await(await fetch(r+"/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l.name,description:l.description,challenges:o})})).json();a.error?alert(a.msg):alert("\u904A\u6232\u5DF2\u5EFA\u7ACB\uFF01 ID: "+a.id)}e.target.disabled=!1}function V(e){try{const[i,t]=e.split(",").map(a=>parseFloat(a.trim()));return!(isNaN(i)||isNaN(t)||i<-90||i>90||t<-180||t>180)}catch{return!1}}function L(e){V(e.target.value)?e.target.classList.remove("error"):e.target.classList.add("error")}function x(){try{if(l.name.length===0||l.name.length>30)return alert("\u904A\u6232\u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143"),!1;if(l.description.length===0||l.description.length>1e3)return alert("\u904A\u6232\u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143"),!1;if(o.length===0||o.length>100)return alert("\u95DC\u5361\u7E3D\u6578\u9700\u4ECB\u65BC 1 ~ 100 \u500B"),!1;for(const e of o){if(e.name.length===0||e.name.length>30)return alert(`\u95DC\u5361 ${e.name} \u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143`),!1;if(e.description.length===0||e.description.length>1e3)return alert(`\u95DC\u5361 ${e.name} \u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143`),!1;if(e.points<0||e.points>1e9)return alert(`\u95DC\u5361 ${e.name} \u734E\u52F5\u5206\u6578\u9700\u4ECB\u65BC 0 ~ 1000000000`),!1;if(e.mode<0||e.mode>=c.length)return alert(`\u95DC\u5361 ${e.name} \u6A21\u5F0F\u932F\u8AA4`),!1;if(e.mode===0&&!V(e.gps))return alert(`\u95DC\u5361 ${e.name} GPS \u4F4D\u7F6E\u932F\u8AA4`),!1;if(e.mode===1&&e.secret.length===0)return alert(`\u95DC\u5361 ${e.name} \u901A\u95DC\u5BC6\u78BC\u4E0D\u53EF\u70BA\u7A7A`),!1}return!0}catch{return alert("\u8CC7\u6599\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u586B\u5BEB"),!1}}return(e,i)=>(d(),u("div",M,[G,A,s("div",B,[D,p(s("input",{class:"ch-input","onUpdate:modelValue":i[0]||(i[0]=t=>_(l).name=t),placeholder:"\u6211\u7684\u8D85\u9177\u904A\u6232"},null,512),[[f,_(l).name]]),I,p(s("input",{class:"ch-input","onUpdate:modelValue":i[1]||(i[1]=t=>_(l).description=t),placeholder:"\u904A\u6232\u7684\u8AAA\u660E"},null,512),[[f,_(l).description]]),T,s("input",{class:"ch-input",value:_(o).length,disabled:""},null,8,E),J,s("input",{class:"ch-input",value:_(o).reduce((t,a)=>t+a.points,0),disabled:""},null,8,q)]),s("div",{id:"save-game",class:"ch",onClick:w},z),s("div",null,[(d(!0),u(k,null,N(_(o),(t,a)=>(d(),u("div",{key:a,class:"ch"},[H,p(s("input",{type:"text",class:"ch-input","onUpdate:modelValue":n=>t.name=n,placeholder:"\u8D85\u9177\u7684\u7B2C "+(a+1)+" \u95DC",title:"\u95DC\u5361\u540D\u7A31"},null,8,Q),[[f,t.name]]),R,p(s("input",{type:"text",class:"ch-input","onUpdate:modelValue":n=>t.description=n,placeholder:"\u95DC\u65BC\u9019\u95DC\u7684\u524D\u60C5\u63D0\u8981\uFF1F\u6216\u662F\u5167\u5BB9\u8AAA\u660E\uFF1F",title:"\u95DC\u5361\u8AAA\u660E"},null,8,W),[[f,t.description]]),X,p(s("input",{type:"number",class:"ch-input","onUpdate:modelValue":n=>t.points=n,placeholder:"\u7B2C "+(a+1)+" \u95DC\u7684\u5206\u6578",title:"\u95DC\u5361\u5206\u6578"},null,8,Y),[[f,t.points]]),Z,p(s("select",{class:"ch-input","onUpdate:modelValue":n=>t.mode=n},[(d(),u(k,null,N(c,(n,y)=>s("option",{value:y},$(n),9,te)),64))],8,ee),[[P,t.mode]]),t.mode==0?(d(),u("label",le,"\u76EE\u7684\u5730 GPS \u5EA7\u6A19")):v("",!0),t.mode==0?p((d(),u("input",{key:1,type:"text",class:"ch-input","onUpdate:modelValue":n=>t.gps=n,placeholder:"25.0275, 121.5282",title:"GPS",onInput:L},null,40,se)),[[f,t.gps]]):v("",!0),t.mode==1?(d(),u("label",oe,"\u901A\u95DC\u5BC6\u78BC")):v("",!0),t.mode==1?p((d(),u("input",{key:3,type:"text",class:"ch-input","onUpdate:modelValue":n=>t.secret=n,placeholder:"\u7B2C "+(a+1)+" \u95DC\u7684\u901A\u95DC\u5BC6\u78BC",title:"\u901A\u95DC\u5BC6\u78BC"},null,8,ne)),[[f,t.secret]]):v("",!0),s("button",{class:"ch-del",onClick:n=>S(a),tabindex:"-1"},"\u522A\u9664",8,ae)]))),128)),s("div",{id:"add-challenge",class:"ch",onClick:b},re)])]))}};j(ce).mount("#app");
