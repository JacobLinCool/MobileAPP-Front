var P=Object.defineProperty;var T=(r,s,C)=>s in r?P(r,s,{enumerable:!0,configurable:!0,writable:!0,value:C}):r[s]=C;var f=(r,s,C)=>(T(r,typeof s!="symbol"?s+"":s,C),C);import{d as G,z as M,n as v,c as p,q as h,e as u,g as c,A as m,F,s as g,p as L,b as O,o as _,t as S,B as J,v as D,y as q}from"./vendor.8a3ab317.js";import{S as U}from"./sweetalert2.314ae3be.js";import{e as z}from"./api.a6e8cdff.js";import{_ as R}from"./index.77b72fb4.js";const a=r=>(L("data-v-19b67be0"),r=r(),O(),r),H={id:"create"},K={id:"container"},Q=a(()=>u("div",{id:"safe-area",class:"w-full my-3"},null,-1)),W={id:"wrapper"},X=a(()=>u("h1",{class:"text-xl"},"\u5EFA\u7ACB\u904A\u6232",-1)),Y=a(()=>u("p",null,null,-1)),Z={class:"ch game"},ee=a(()=>u("label",{class:"ch-label"},"\u904A\u6232\u540D\u7A31",-1)),ue=a(()=>u("label",{class:"ch-label"},"\u904A\u6232\u8AAA\u660E",-1)),te=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u6578",-1)),se=["value"],oe=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u7E3D\u5206",-1)),le=["value"],ne={class:"ch teams"},ae=a(()=>u("label",{class:"ch-label"},"\u5206\u7D44\u7D44\u5225",-1)),ie={class:"ch-team"},ce={class:"ch-label"},re=["onUpdate:modelValue"],de=a(()=>u("button",null,"\u5132\u5B58",-1)),pe=[de],he=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u540D\u7A31",-1)),_e=["onUpdate:modelValue","placeholder"],me=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u8AAA\u660E",-1)),Ce=["onUpdate:modelValue"],fe=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u5206\u6578",-1)),Ae=["onUpdate:modelValue","placeholder"],Be=a(()=>u("label",{class:"ch-label"},"\u95DC\u5361\u6A21\u5F0F",-1)),De=["onUpdate:modelValue"],be=["value"],ve={key:0,class:"ch-label"},Fe=["onUpdate:modelValue"],ge={key:2,class:"ch-label"},Ee=["onUpdate:modelValue","placeholder"],ye=["onClick"],Ve=a(()=>u("button",null,"\u65B0\u589E",-1)),Se=[Ve],Ue=G({setup(r){function s(n,e=""){return U.fire({title:n,text:e,icon:"error",confirmButtonText:"\u78BA\u5B9A"})}function C(n,e=""){return U.fire({title:n,text:e,icon:"success",confirmButtonText:"\u78BA\u5B9A"})}const w=M(),E=["GPS \u5B9A\u4F4D\u6311\u6230","\u901A\u95DC\u5BC6\u78BC\u6311\u6230"];class y{constructor(e="",t="",l=10,o=0){f(this,"name","");f(this,"description","");f(this,"points",0);f(this,"mode",0);f(this,"secret","");f(this,"gps","");this.name=e,this.description=t,this.points=l,this.mode=o,this.secret=Math.floor(36**5+1+Math.random()*(36**5*35-1)).toString(36)}}const d=v({name:"",description:""}),i=v([new y]),A=v([]);function k(){i.push(new y),console.log(i)}function x(n){i.splice(n,1),console.log(i)}async function N(n){const e=n.target;e.disabled=!0;const t=j();if(console.log("validation: ",t),t){for(const b of i)b.gps&&(b.gps=b.gps.split(",").map(I=>parseFloat(I.trim())).splice(0,2).join(","));const l={name:d.name,description:d.description,challenges:i,teams:A};console.log(JSON.stringify(l,null,2));const B=await(await fetch(z+"/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();B.error?s("\u932F\u8AA4",B.msg):C("\u904A\u6232\u5DF2\u5EFA\u7ACB\uFF01 ID: "+B.id).then(()=>{w.push("/play?id="+B.id)})}e.disabled=!1}function V(n){try{const[e,t]=n.split(",").map(l=>parseFloat(l.trim()));return!(isNaN(e)||isNaN(t)||e<-90||e>90||t<-180||t>180)}catch{return!1}}function $(n){const e=n.target;V(e.value)?e.classList.remove("error"):e.classList.add("error")}function j(){try{if(d.name.length===0||d.name.length>30)return s("\u904A\u6232\u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143"),!1;if(d.description.length===0||d.description.length>1e3)return s("\u904A\u6232\u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143"),!1;if(i.length===0||i.length>100)return s("\u95DC\u5361\u7E3D\u6578\u9700\u4ECB\u65BC 1 ~ 100 \u500B"),!1;for(const e of i){if(e.name.length===0||e.name.length>30)return s(`\u95DC\u5361 ${e.name} \u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143`),!1;if(e.description.length===0||e.description.length>1e3)return s(`\u95DC\u5361 ${e.name} \u63CF\u8FF0\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 1000 \u5B57\u5143`),!1;if(e.points<0||e.points>1e9)return s(`\u95DC\u5361 ${e.name} \u734E\u52F5\u5206\u6578\u9700\u4ECB\u65BC 0 ~ 1000000000`),!1;if(e.mode<0||e.mode>=E.length)return s(`\u95DC\u5361 ${e.name} \u6A21\u5F0F\u932F\u8AA4`),!1;if(e.mode===0&&!V(e.gps))return s(`\u95DC\u5361 ${e.name} GPS \u4F4D\u7F6E\u932F\u8AA4`),!1;if(e.mode===1&&e.secret.length===0)return s(`\u95DC\u5361 ${e.name} \u901A\u95DC\u5BC6\u78BC\u4E0D\u53EF\u70BA\u7A7A`),!1}const n=new Set;for(const e of A){if(e.length===0||e.length>30)return s("\u968A\u4F0D\u540D\u7A31\u9577\u5EA6\u9700\u4ECB\u65BC 1 ~ 30 \u5B57\u5143"),!1;if(n.has(e))return s("\u968A\u4F0D\u540D\u7A31\u4E0D\u53EF\u91CD\u8907"),!1;n.add(e)}return!0}catch{return s("\u8CC7\u6599\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u586B\u5BEB"),!1}}return(n,e)=>(_(),p("div",H,[h(u("div",K,[Q,u("div",W,[X,Y,u("div",Z,[ee,h(u("input",{class:"ch-input","onUpdate:modelValue":e[0]||(e[0]=t=>c(d).name=t),placeholder:"\u6211\u7684\u8D85\u9177\u904A\u6232"},null,512),[[m,c(d).name]]),ue,h(u("input",{class:"ch-input","onUpdate:modelValue":e[1]||(e[1]=t=>c(d).description=t),placeholder:"\u904A\u6232\u7684\u8AAA\u660E"},null,512),[[m,c(d).description]]),te,u("input",{class:"ch-input",value:c(i).length,disabled:""},null,8,se),oe,u("input",{class:"ch-input",value:c(i).reduce((t,l)=>t+l.points,0),disabled:""},null,8,le)]),u("div",ne,[ae,(_(!0),p(F,null,g(c(A),(t,l)=>(_(),p("div",ie,[u("label",ce,"\u7B2C "+S(l+1)+" \u7D44\u540D\u7A31",1),h(u("input",{class:"ch-input","onUpdate:modelValue":o=>c(A)[l]=o,placeholder:"\u7D44\u5225\u540D\u7A31"},null,8,re),[[m,c(A)[l]]])]))),256)),u("button",{class:"ch-button text-right w-full pr-2",onClick:e[2]||(e[2]=t=>c(A).push(""))},"\u65B0\u589E\u7D44\u5225")]),u("div",{id:"save-game",class:"ch",onClick:N},pe),u("div",null,[(_(!0),p(F,null,g(c(i),(t,l)=>(_(),p("div",{key:l,class:"ch"},[he,h(u("input",{type:"text",class:"ch-input","onUpdate:modelValue":o=>t.name=o,placeholder:"\u8D85\u9177\u7684\u7B2C "+(l+1)+" \u95DC",title:"\u95DC\u5361\u540D\u7A31"},null,8,_e),[[m,t.name]]),me,h(u("input",{type:"text",class:"ch-input","onUpdate:modelValue":o=>t.description=o,placeholder:"\u95DC\u65BC\u9019\u95DC\u7684\u524D\u60C5\u63D0\u8981\uFF1F\u6216\u662F\u5167\u5BB9\u8AAA\u660E\uFF1F",title:"\u95DC\u5361\u8AAA\u660E"},null,8,Ce),[[m,t.description]]),fe,h(u("input",{type:"number",class:"ch-input","onUpdate:modelValue":o=>t.points=o,placeholder:"\u7B2C "+(l+1)+" \u95DC\u7684\u5206\u6578",title:"\u95DC\u5361\u5206\u6578"},null,8,Ae),[[m,t.points]]),Be,h(u("select",{class:"ch-input","onUpdate:modelValue":o=>t.mode=o},[(_(),p(F,null,g(E,(o,B)=>u("option",{value:B},S(o),9,be)),64))],8,De),[[J,t.mode]]),t.mode==0?(_(),p("label",ve,"\u76EE\u7684\u5730 GPS \u5EA7\u6A19")):D("",!0),t.mode==0?h((_(),p("input",{key:1,type:"text",class:"ch-input","onUpdate:modelValue":o=>t.gps=o,placeholder:"25.0275, 121.5282",title:"GPS",onInput:$},null,40,Fe)),[[m,t.gps]]):D("",!0),t.mode==1?(_(),p("label",ge,"\u901A\u95DC\u5BC6\u78BC")):D("",!0),t.mode==1?h((_(),p("input",{key:3,type:"text",class:"ch-input","onUpdate:modelValue":o=>t.secret=o,placeholder:"\u7B2C "+(l+1)+" \u95DC\u7684\u901A\u95DC\u5BC6\u78BC",title:"\u901A\u95DC\u5BC6\u78BC"},null,8,Ee)),[[m,t.secret]]):D("",!0),u("button",{class:"ch-del",onClick:o=>x(l),tabindex:"-1"},"\u522A\u9664",8,ye)]))),128)),u("div",{id:"add-challenge",class:"ch",onClick:k},Se)])])],512),[[q,!0]])]))}});var je=R(Ue,[["__scopeId","data-v-19b67be0"]]);export{je as default};
